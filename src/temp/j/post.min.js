if (
	((function (e) {
		"use strict";
		if ("querySelectorAll" in e) {
			var t,
				n,
				o,
				a,
				r,
				i,
				s,
				l,
				c = e.querySelectorAll("[data-quotable]"),
				d = c.length,
				u = /^(blockquote|[uod]l|p|h[1-6])$/,
				p = /^(body|main|section|article|aside)$/,
				h = /^h[1-6]$/;
			if (d)
				for (
					(r = e.createElement("blockquote")).setAttribute("class", "quotable"),
						r.setAttribute("aria-hidden", "true"),
						r.appendChild(e.createElement("p"));
					d--;
				) {
					for (
						t = c[d],
							n = r.cloneNode(!0),
							a = (o = t.innerText.split(" ")).pop(),
							n.querySelector("p").innerText = o.join(" ") + " " + a;
						!t.nodeName.toLowerCase().match(u) &&
						!t.nodeName.toLowerCase().match(p);
					)
						t = t.parentNode;
					for (i = t.parentNode, s = t.previousElementSibling; s; ) {
						if (s.nodeName.toLowerCase().match(h)) {
							l = s;
							break;
						}
						s = s.previousElementSibling;
					}
					if (l)
						for (
							s = l.nextElementSibling.nextElementSibling;
							"blockquote" == s.nodeName.toLowerCase();
						)
							s = s.nextElementSibling.nextElementSibling;
					s ? i.insertBefore(n, s) : i.insertBefore(n, t);
				}
		}
	})(document),
	(function (e) {
		if ("serviceWorker" in navigator) {
			var t = document.createElement("button"),
				n = document.createElement("dt"),
				o = document.createElement("dd"),
				a = document.createDocumentFragment(),
				r = e.sw_version + "posts",
				i = e.caches,
				s = e.location.href;
			((t.innerText = "Save offline"),
				i.match(s).then((e) => {
					e && ((t.innerText = "Already saved!"), (t.disabled = !0));
				}),
				t.addEventListener(
					"click",
					function (e) {
						(e.preventDefault(),
							(t.innerText = "Saving…"),
							i.open(r).then((e) => {
								e.add(s)
									.then(function () {
										((t.innerText = "Saved!"), (t.disabled = !0));
										var e = {
											title: document
												.querySelector("[property='og:title']")
												.getAttribute("content"),
											description: document
												.querySelector("meta[name='description']")
												.getAttribute("content"),
										};
										localStorage.setItem(s, JSON.stringify(e));
									})
									.catch(function () {
										t.innerText = "Save failed :-(";
									});
							}));
					},
					!1,
				),
				n.classList.add("dont-read"),
				(n.innerText = "Want to read this offline?"),
				a.appendChild(n),
				o.appendChild(t),
				o.classList.add("dont-read"),
				a.appendChild(o),
				document.querySelector(".entry__meta").appendChild(a));
		}
	})(this),
	(function (e, t) {
		"use strict";
		if ("querySelectorAll" in t) {
			var n = t.querySelectorAll(".entry__sharing"),
				o = 640;
			n.length > 0 &&
				n[0].addEventListener(
					"click",
					function (t) {
						var n = t.target;
						if ("a" == t.target.nodeName.toLowerCase() && e.innerWidth >= o)
							return (
								t.preventDefault(),
								e.open(
									n.href,
									"share-this",
									"height=300,width=500,status=no,toolbar=no",
								),
								!1
							);
					},
					!1,
				);
		}
	})(this, this.document),
	(function (e) {
		"use strict";
		"addEventListener" in e &&
			e.addEventListener(
				"load",
				function () {
					var e = document
							.getElementById("webmentions")
							.getElementsByTagName("img"),
						t = e.length;
					for (; t--; )
						e[t].naturalWidth || (e[t].src = "/i/fallbacks/avatar.svg");
					e = null;
				},
				!1,
			);
	})(this),
	"speechSynthesis" in window)
) {
	function play() {
		paused
			? window.speechSynthesis.resume()
			: window.speechSynthesis.speak(speech);
	}
	function pause() {
		(window.speechSynthesis.pause(), (paused = !0));
	}
	window.addEventListener("beforeunload", function () {
		window.speechSynthesis.cancel();
	});
	var text,
		$play,
		$pause,
		speech = new SpeechSynthesisUtterance(),
		paused = !1,
		progress_index = 0,
		$content = document.querySelector("main").cloneNode(!0),
		$space = $content.querySelectorAll("pre"),
		$pause_before = $content.querySelectorAll(
			"h2, h3, h4, h5, h6, p, li, dt, blockquote, pre, figure, footer",
		),
		$skip = $content.querySelectorAll(".anchorable__anchor, aside, .dont-read"),
		$intro = document.createElement("dt"),
		$controls = document.createElement("dd"),
		$button = document.createElement("button"),
		$buttons = document.createElement("p"),
		default_speed = 1.4,
		$caveat = $buttons.cloneNode(!0);
	(Array.prototype.forEach.call($skip, function (e) {
		e.innerHTML = "";
	}),
		Array.prototype.forEach.call($space, function (e) {
			e.innerHTML = " " + e.innerHTML.replace(/[\r\n\t]/g, " ") + " ";
		}),
		Array.prototype.forEach.call($pause_before, function (e) {
			e.innerHTML = " , " + e.innerHTML;
		}),
		(speech.onboundary = function (e) {
			"word" == e.name && (progress_index = e.charIndex);
		}),
		(speech.onend = function (e) {
			window.speechSynthesis.cancel();
		}),
		(text = $content.textContent),
		(speech.text = text),
		($intro.innerHTML = "Would you prefer to have this post read to you?"),
		$controls.classList.add("media-controls"),
		$buttons.classList.add("media-controls__buttons"),
		$button.classList.add("media-controls__button"),
		($play = $button.cloneNode("true")).classList.add(
			"media-controls__button--play",
		),
		$play.setAttribute("aria-label", "Play"),
		$play.addEventListener("click", play, !1),
		$buttons.appendChild($play),
		($pause = $button.cloneNode("true")).classList.add(
			"media-controls__button--pause",
		),
		$pause.setAttribute("aria-label", "Pause"),
		$pause.addEventListener("click", pause, !1),
		$buttons.appendChild($pause),
		$controls.appendChild($buttons),
		(speech.rate = default_speed),
		($caveat.innerHTML =
			"<small>SpeechSynthesis is still experimental. This could be buggy</small>"),
		$controls.appendChild($caveat),
		document.querySelector(".entry__meta").appendChild($intro),
		document.querySelector(".entry__meta").appendChild($controls));
}
