"use strict";var version="v1447870462589:",default_avatar="https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mm&f=y",missing_image="https://i.imgur.com/oWLuFAa.gif";self.addEventListener("activate",function(e){e.waitUntil(caches.keys().then(function(e){return Promise.all(e.filter(function(e){return!e.startsWith(version)}).map(function(e){return caches["delete"](e)}))}))}),self.addEventListener("fetch",function(e){function t(){for(var e=o.length;e--;)if(i.indexOf(o[e])>-1)return!0;return!1}function n(){for(var e=u.length;e--;)if(i.indexOf(u[e])>-1)return!0;return!1}function a(e){var t=e.clone();return caches.open(version+"pages").then(function(e){e.put(c,t)}).then(function(){}),e}function r(){var e=c.headers.get("Accept"),t=new URL(i);return e.indexOf("image")>-1?"www.gravatar.com"===t.host?caches.match(default_avatar):caches.match(missing_image):s()}function s(){return new Response("<h1>Service Unavailable</h1>",{status:503,statusText:"Service Unavailable",headers:new Headers({"Content-Type":"text/html"})})}var c=e.request,i=c.url,o=["p.typekit.net/p.gif","www.google-analytics.com/r/collect"],u=["https://pbs.twimg.com","https://webmention.io/avatar/","https://images1-focus-opensocial.googleusercontent.com/gadgets/proxy"];"GET"!==c.method||t()||e.respondWith(caches.match(c).then(function(e){if(e&&n())return e;var t=fetch(c).then(a,r)["catch"](r);return e||t}))}),self.addEventListener("fetch",function(e){var t=e.request,n=t.url,a=/^(?:https?:)?\/\/www\.aaron-gustafson\.com\/.+\.(:?jpg|png)$/;if(a.test(n)){var r,s=!1;t.headers.has("accept")&&(s=t.headers.get("accept").includes("webp")),s&&(r=n.substr(0,n.lastIndexOf("."))+".webp",e.respondWith(fetch(r,{mode:"no-cors"})))}}),self.addEventListener("install",function(e){var t=["favicon.png","c/default.css","c/advanced.css","j/main.js",default_avatar,missing_image];e.waitUntil(caches.open(version+"assets").then(function(e){return e.addAll(t)}))});