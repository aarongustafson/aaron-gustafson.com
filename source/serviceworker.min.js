"use strict";var version="v1::",default_avatar="https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mm&f=y",missing_image="https://i.imgur.com/oWLuFAa.gif";self.addEventListener("activate",function(e){console.log("WORKER: activate event in progress."),e.waitUntil(caches.keys().then(function(e){return Promise.all(e.filter(function(e){return!e.startsWith(version)}).map(function(e){return caches["delete"](e)}))}).then(function(){console.log("WORKER: activate completed.")}))}),self.addEventListener("fetch",function(e){function t(t){var n=t.clone();return console.log("WORKER: fetch response from network.",e.request.url),caches.open(version+"pages").then(function(t){t.put(e.request,n)}).then(function(){console.log("WORKER: fetch response stored in cache.",e.request.url)}),t}function n(){console.log("WORKER: fetch request failed in both cache and network.");var e=request.headers.get("Accept"),t=new URL(request.url);return e.indexOf("image")>-1?"www.gravatar.com"===t.host?caches.match(default_avatar):caches.match(missing_image):s()}function s(){return new Response("<h1>Service Unavailable</h1>",{status:503,statusText:"Service Unavailable",headers:new Headers({"Content-Type":"text/html"})})}return console.log("WORKER: fetch event in progress."),"GET"!==e.request.method?void console.log("WORKER: fetch event ignored.",e.request.method,e.request.url):void e.respondWith(caches.match(e.request).then(function(s){var r=fetch(e.request).then(t,n)["catch"](n);return console.log("WORKER: fetch event",s?"(cached)":"(network)",e.request.url),s||r}))}),self.addEventListener("fetch",function(e){if(/\.jpg$|.png$/.test(e.request.url)){var t,n=!1;e.request.headers.has("accept")&&(n=e.request.headers.get("accept").includes("webp")),n&&(t=e.request.url.substr(0,e.request.url.lastIndexOf("."))+".webp",e.respondWith(fetch(t,{mode:"no-cors"})))}}),self.addEventListener("install",function(e){console.log("WORKER: install event in progress.");var t=["favicon.png","c/default.css","c/advanced.css","j/main.js",default_avatar,missing_image];e.waitUntil(caches.open(version+"assets").then(function(e){return e.addAll(t)}).then(function(){console.log("WORKER: install completed")}))});